<section class="player-profile">

  <!-- ========================= -->
  <!-- PROFƒ∞L OLU≈ûTURMA -->
  <!-- ========================= -->
  <div class="profile-create" *ngIf="!profileCompleted">

    <div class="edit-card">
      <h2>Oyuncu Profilini Olu≈ütur</h2>
      <p>Ma√ßlara katƒ±lmak i√ßin profilini doldur.</p>

      <input type="text" placeholder="Ad Soyad" [(ngModel)]="profile.fullName" />
      <input type="number" placeholder="Ya≈ü" [(ngModel)]="profile.age" />

      <div class="row">
        <input type="number" placeholder="Boy (cm)" [(ngModel)]="profile.heightCm" />
        <input type="number" placeholder="Kilo (kg)" [(ngModel)]="profile.weightKg" />
      </div>

      <div class="select-wrapper">
        <select [(ngModel)]="profile.city" (change)="onCityChange()">
          <option value="">≈ûehir Se√ß</option>
          <option *ngFor="let city of cities" [value]="city">{{ city }}</option>
        </select>
      </div>

      <div class="select-wrapper">
        <select [(ngModel)]="profile.district" [disabled]="!profile.city">
          <option value="">ƒ∞l√ße Se√ß</option>
          <option *ngFor="let d of districts" [value]="d">{{ d }}</option>
        </select>
      </div>

      <div class="select-wrapper">
        <select [(ngModel)]="profile.preferredFoot">
          <option value="">G√º√ßl√º Ayak</option>
          <option *ngFor="let foot of footOptions" [value]="foot">{{ foot }}</option>
        </select>
      </div>

      <h4>Mevkiler</h4>
      <div class="positions">
        <button *ngFor="let pos of positions"
          (click)="togglePosition(pos)"
          [class.active]="profile.positions.includes(pos)">
          {{ pos }}
        </button>
      </div>

      <textarea
        placeholder="Oynadƒ±ƒüƒ±n takƒ±mlar, akademiler, turnuvalar vs."
        [(ngModel)]="profile.teamsPlayed">
      </textarea>

      <button
        class="save-btn"
        style="background:linear-gradient(90deg,#7b2cff,#f5c77a);border:none;color:black;font-weight:700;"
        (click)="saveProfile()">
        Profili Kaydet
      </button>
    </div>

  </div>

 <!-- ========================= -->
<!-- PROFƒ∞L -->
<!-- ========================= -->
<ng-container *ngIf="profileCompleted">

  <!-- ===== ALL CARDS SAME GRID ===== -->
  <div
    style="
      display:grid;
      grid-template-columns:repeat(5,1fr);
      gap:16px;
      width:100%;
      margin-bottom:48px;
    ">

    <!-- ================= HERO CARD (SAME SIZE) ================= -->
    <div
      class="hero-card-wrapper"
      [ngClass]="isPremium ? 'gold' : 'silver'"
      style="position:relative;">

      <app-player-hero-card
        [fullName]="profile.fullName"
        [position]="profile.positions[0]"
        [rating]="82"
        [cardTier]="isPremium ? 'gold' : 'silver'"
        referencePlayer="Mbapp√©"
        [isPremium]="isPremium">
      </app-player-hero-card>

      <!-- PREMIUM BADGE + LOCK -->
      <div
        *ngIf="!isPremium"
        class="hero-premium-overlay"
        style="
          position:absolute;
          inset:0;
          border-radius:16px;
          background:linear-gradient(180deg, rgba(10,12,40,0.25), rgba(10,12,40,0.85));
          display:flex;
          align-items:flex-end;
          justify-content:center;
          padding-bottom:14px;
          pointer-events:none;
        "
      >
        <div
          style="
            background:linear-gradient(90deg,#7b2cff,#4cc9f0);
            padding:6px 14px;
            border-radius:20px;
            font-size:12px;
            font-weight:700;
            color:white;
            box-shadow:0 0 12px rgba(123,44,255,0.6);
          "
        >
          üîí Rating Premium‚Äôda
        </div>
      </div>

    </div>

    <!-- ================= 1. PLAYER INFO ================= -->
    <div class="profile-card">
      <h2>Oyuncu Bilgileri</h2>

      <ng-container *ngIf="!isEditingProfile">
        <p><b>Ad:</b> {{ profile.fullName }}</p>
        <p><b>Ya≈ü:</b> {{ profile.age }}</p>
        <p><b>Fizik:</b> {{ profile.heightCm }} / {{ profile.weightKg }}</p>
        <p><b>Mevki:</b> {{ profile.positions.join(', ') }}</p>
        <p><b>Ayak:</b> {{ profile.preferredFoot }}</p>
        <p><b>Lokasyon:</b> {{ profile.city }} / {{ profile.district }}</p>
        <p><b>Takƒ±mlar:</b> {{ profile.teamsPlayed || '-' }}</p>

        <button
          style="margin-top:8px;background:linear-gradient(90deg,#7b2cff,#4cc9f0);border:none;color:white;padding:6px 12px;border-radius:10px;"
          (click)="startEditProfile()">
          Profili D√ºzenle
        </button>
      </ng-container>

      <ng-container *ngIf="isEditingProfile">

        <input placeholder="Ad Soyad" [(ngModel)]="profile.fullName" />
        <input type="number" placeholder="Ya≈ü" [(ngModel)]="profile.age" />

        <div class="row">
          <input type="number" placeholder="Boy (cm)" [(ngModel)]="profile.heightCm" />
          <input type="number" placeholder="Kilo (kg)" [(ngModel)]="profile.weightKg" />
        </div>

        <div class="select-wrapper">
          <select [(ngModel)]="profile.city" (change)="onCityChange()">
            <option value="">≈ûehir Se√ß</option>
            <option *ngFor="let city of cities" [value]="city">{{ city }}</option>
          </select>
        </div>

        <div class="select-wrapper">
          <select [(ngModel)]="profile.district">
            <option value="">ƒ∞l√ße Se√ß</option>
            <option *ngFor="let d of districts" [value]="d">{{ d }}</option>
          </select>
        </div>

        <div class="select-wrapper">
          <select [(ngModel)]="profile.preferredFoot">
            <option value="">G√º√ßl√º Ayak</option>
            <option *ngFor="let foot of footOptions" [value]="foot">{{ foot }}</option>
          </select>
        </div>

        <div class="positions">
          <button *ngFor="let pos of positions"
            (click)="togglePosition(pos)"
            [class.active]="profile.positions.includes(pos)">
            {{ pos }}
          </button>
        </div>

        <textarea placeholder="Takƒ±mlar / akademiler" [(ngModel)]="profile.teamsPlayed"></textarea>

        <div style="display:flex; gap:8px;">
          <button
            style="background:linear-gradient(90deg,#f5c77a,#ffd166);border:none;padding:6px 12px;border-radius:10px;"
            (click)="saveEditProfile()">Kaydet</button>

          <button
            style="background:#222;border:1px solid #444;padding:6px 12px;border-radius:10px;color:#aaa;"
            (click)="cancelEditProfile()">Vazge√ß</button>
        </div>

      </ng-container>
    </div>

    <!-- ================= 2. CV ================= -->
    <div class="profile-card">
      <h2>√ñzge√ßmi≈ü</h2>

      <p *ngIf="hasCv && !isEditingCv" style="opacity:.9;font-size:13px;">
        {{ cvText }}
      </p>

      <p *ngIf="!hasCv && !isEditingCv" style="opacity:.6;">
        Hen√ºz √∂zge√ßmi≈ü eklenmedi.
      </p>

      <button
        *ngIf="!isEditingCv"
        style="margin-top:8px;background:linear-gradient(90deg,#7b2cff,#4cc9f0);border:none;color:white;padding:6px 12px;border-radius:10px;"
        (click)="startEditCv()">
        {{ hasCv ? 'D√ºzenle' : '√ñzge√ßmi≈ü Ekle' }}
      </button>

      <ng-container *ngIf="isEditingCv">
        <textarea
          [(ngModel)]="cvText"
          placeholder="Kendinizden bahsedin (ne kadar detaylƒ± yazarsanƒ±z o kadar √∂ne √ßƒ±karsƒ±nƒ±z)">
        </textarea>
        <div style="display:flex; gap:8px;">
          <button
            style="background:linear-gradient(90deg,#f5c77a,#ffd166);border:none;padding:6px 12px;border-radius:10px;"
            (click)="saveCv()">Kaydet</button>
          <button
            style="background:#222;border:1px solid #444;padding:6px 12px;border-radius:10px;color:#aaa;"
            (click)="cancelCv()">Vazge√ß</button>
        </div>
      </ng-container>
    </div>

    <!-- ================= 3. PHOTOS ================= -->
    <div class="profile-card">
      <h2>Fotoƒüraflar</h2>
      <p *ngIf="!hasPhoto">Hen√ºz fotoƒüraf eklenmedi.</p>
      <p *ngIf="hasPhoto">Fotoƒüraf y√ºklendi ‚úÖ</p>
      <button
        style="margin-top:8px;background:linear-gradient(90deg,#7b2cff,#4cc9f0);border:none;color:white;padding:6px 12px;border-radius:10px;"
        (click)="addPhoto()">Fotoƒüraf Ekle</button>
    </div>

    <!-- ================= 4. VIDEOS ================= -->
    <div class="profile-card">
      <h2>Videolar</h2>
      <p *ngIf="!hasVideo">Hen√ºz video eklenmedi.</p>
      <p *ngIf="hasVideo">Video y√ºklendi ‚úÖ</p>
      <button
        style="margin-top:8px;background:linear-gradient(90deg,#7b2cff,#4cc9f0);border:none;color:white;padding:6px 12px;border-radius:10px;"
        (click)="addVideo()">Video Ekle</button>
    </div>

  </div>

  <!-- ===== AI ANALYSIS (LOCKED IF NOT PREMIUM) ===== -->

  <div class="ai-lock-wrapper">

    <div class="ai-blur-content" [class.locked]="!isPremium">

      <app-player-rating [isPremium]="isPremium"></app-player-rating>

      <app-player-meta
        [meta]="{
          age: profile.age ?? undefined,
          city: profile.city,
          country: 'T√ºrkiye'
        }">
      </app-player-meta>

      <app-player-media [isPremium]="isPremium"></app-player-media>

      <app-premium-ai-preview *ngIf="isPremium"></app-premium-ai-preview>

    </div>

    <div class="ai-lock-overlay" *ngIf="!isPremium">
      <div class="lock-box">
        üîí <strong>AI Analizi Premium‚Äôda A√ßƒ±lƒ±r</strong>
        <p>Detaylƒ± performans puanlarƒ± ve video analizi i√ßin Premium‚Äôa ge√ß.</p>
      </div>
    </div>

  </div>

</ng-container>


</section>
