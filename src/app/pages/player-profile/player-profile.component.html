<section class="player-profile">

  <!-- ========================= -->
  <!-- PROFƒ∞L YOKSA -->
  <!-- ========================= -->
  <div *ngIf="!profileCompleted && !isEditingProfile" class="empty-profile">
    <h2>Hen√ºz Oyuncu Profilin Yok</h2>
    <p>Ma√ßlara ba≈üvurabilmek i√ßin √∂nce profilini olu≈üturmalƒ±sƒ±n.</p>
    <button class="save-btn" (click)="startCreateProfile()">Profili Olu≈ütur</button>
  </div>

  <!-- ========================= -->
  <!-- PROFƒ∞L OLU≈ûTUR / D√úZENLE -->
  <!-- ========================= -->
  <div *ngIf="isEditingProfile" class="player-create">

    <h1 class="create-title">Oyuncu Profilini Olu≈ütur</h1>

    <div class="create-layout">

      <!-- FORM CARD -->
      <div class="form-card">

        <div class="grid-2">
          <input placeholder="Ad Soyad" [(ngModel)]="profile.fullName" />
          <input type="number" placeholder="Ya≈ü" [(ngModel)]="profile.age" />
        </div>

        <div class="grid-2">
          <input type="number" placeholder="Boy (cm)" [(ngModel)]="profile.heightCm" />
          <input type="number" placeholder="Kilo (kg)" [(ngModel)]="profile.weightKg" />
        </div>

        <div class="grid-2">
          <select [(ngModel)]="profile.city" (change)="onCityChange()">
            <option value="">≈ûehir Se√ß</option>
            <option *ngFor="let c of cities" [value]="c">{{ c }}</option>
          </select>

          <select [(ngModel)]="profile.district" [disabled]="!profile.city">
            <option value="">ƒ∞l√ße Se√ß</option>
            <option *ngFor="let d of districts" [value]="d">{{ d }}</option>
          </select>
        </div>

        <select [(ngModel)]="profile.preferredFoot">
          <option value="">G√º√ßl√º Ayak</option>
          <option *ngFor="let f of footOptions" [value]="f">{{ f }}</option>
        </select>

        <textarea
          placeholder="Takƒ±mlar / akademiler"
          [(ngModel)]="profile.teamsPlayed">
        </textarea>

      </div>

      <!-- SIDE CARD -->
      <div class="side-card">

        <h3>Pozisyonlar</h3>

        <div class="positions-grid">
          <button
            *ngFor="let pos of positions"
            (click)="togglePosition(pos)"
            [class.active]="profile.positions.includes(pos)">
            {{ pos }}
          </button>
        </div>

        <button class="save-btn" (click)="profileCompleted ? saveEditProfile() : saveProfile()">
          Profili Kaydet
        </button>

        <button *ngIf="profileCompleted" class="mini-btn dark" (click)="cancelEditProfile()">
          Vazge√ß
        </button>

      </div>

    </div>
  </div>

  <!-- ========================= -->
  <!-- PROFƒ∞L VARSA -->
  <!-- ========================= -->
  <div *ngIf="profileCompleted && !isEditingProfile" class="profile-grid">

    <!-- HERO CARD -->
    <div class="hero-card-wrapper">
      <app-player-hero-card
        [fullName]="profile.fullName"
        [position]="profile.positions.length ? profile.positions[0] : '‚Äî'"
        [rating]="82"
        cardTier="silver"
        referencePlayer="Mbapp√©"
        [isPremium]="isPremium">
      </app-player-hero-card>
    </div>

    <!-- PLAYER INFO -->
    <div class="profile-card">
      <h2>Oyuncu Bilgileri</h2>
      <p><b>Ad:</b> {{ profile.fullName }}</p>
      <p><b>Ya≈ü:</b> {{ profile.age }}</p>
      <p><b>Fizik:</b> {{ profile.heightCm }} / {{ profile.weightKg }}</p>
      <p><b>Mevki:</b> {{ profile.positions.join(', ') }}</p>
      <p><b>Ayak:</b> {{ profile.preferredFoot }}</p>
      <p><b>Lokasyon:</b> {{ profile.city }} / {{ profile.district }}</p>
      <p><b>Takƒ±mlar:</b> {{ profile.teamsPlayed || '-' }}</p>

      <button class="mini-btn" (click)="startEditProfile()">Profili D√ºzenle</button>
    </div>

    <!-- CV -->
    <div class="profile-card">
      <h2>√ñzge√ßmi≈ü</h2>

      <p *ngIf="hasCv && !isEditingCv">{{ cvText }}</p>
      <p *ngIf="!hasCv && !isEditingCv">Hen√ºz √∂zge√ßmi≈ü eklenmedi.</p>

      <button *ngIf="!isEditingCv" class="mini-btn" (click)="startEditCv()">D√ºzenle</button>

      <ng-container *ngIf="isEditingCv">
        <textarea [(ngModel)]="cvText"></textarea>
        <div style="display:flex; gap:8px;">
          <button class="mini-btn yellow" (click)="saveCv()">Kaydet</button>
          <button class="mini-btn dark" (click)="cancelCv()">Vazge√ß</button>
        </div>
      </ng-container>
    </div>

    <!-- PHOTOS -->
    <div class="profile-card media-card">
      <h2>Fotoƒüraflar ({{ photos.length }}/{{ isPremium ? '‚àû' : '3' }})</h2>

      <div class="media-upload-bar">
        <input type="file" accept="image/*" (change)="onPhotoSelected($event)" />
      </div>

      <div class="media-grid">
        <div class="media-thumb" *ngFor="let p of photos">
          <img [src]="p.url" />
        </div>
      </div>

      <button class="save-btn">Kaydet</button>
    </div>

    <!-- VIDEOS -->
    <div class="profile-card media-card">
      <h2>Videolar ({{ videos.length }}/{{ isPremium ? '‚àû' : '1' }})</h2>

      <div class="media-upload-bar">
        <input type="file" accept="video/*" (change)="onVideoSelected($event)" />
      </div>

      <div class="media-grid">
        <div class="media-thumb" *ngFor="let v of videos">
          <video [src]="v.url" muted></video>
        </div>
      </div>

      <button class="save-btn">Kaydet</button>
    </div>

  </div> <!-- profile-grid END -->

  <!-- ========================= -->
  <!-- AI ANALYSIS HIGHLIGHT -->
  <!-- ========================= -->
  <div class="ai-highlight-section">

    <h2>AI Performans Analizi</h2>
    <p>
      Videolarƒ±n ve istatistiklerin yapay zeka ile analiz edilir,
      elit oyuncularla kar≈üƒ±la≈ütƒ±rƒ±lƒ±rsƒ±n.
    </p>

    <!-- PREMIUM LOCK -->
    <div *ngIf="!isPremium" class="ai-lock-card">
      <div class="lock-icon">üîí</div>
      <h3>AI Analiz Premium</h3>
      <p>Oyuncu kar≈üƒ±la≈ütƒ±rmasƒ± ve rating i√ßin PRO‚Äôya ge√ß</p>
      <button class="save-btn">Footbally PRO</button>
    </div>

    <!-- FUTURE: REAL AI RESULT -->
    <div *ngIf="isPremium" class="ai-result-card">
      <p>AI analiz sonu√ßlarƒ± burada g√∂sterilecek‚Ä¶</p>
    </div>

  </div>

</section>
